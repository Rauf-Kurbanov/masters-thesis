\documentclass[../diploma.tex]{subfiles}
 
\begin{document}

Если дан дополнительный вход $h$ как условие, WaveNet способен моделировать условное распределение $p(x|h)$ аудио по этому входу. Уравнение \ref{eq:wave_distr} теперь принимает вид \ref{eq:wave_cond_distr}:

\begin{equation} \label{eq:wave_cond_distr}
p(x|h) = \prod^{T}_{t=1}{p(x_{t}|x_1, \dots, x_{t-1}, h)}
\end{equation}

Задавая такого рода условия, мы сподвигаем WaveNet к генерации аудио с необходимыми характеристиками. Например, если наши исходные данные для обучения содержат большое количество ораторов, мы можем передавать идентификатор говорящего в качестве глобального условия. Тогда впоследствии при генерации мы сможем выбирать, чью речь мы хотим сгенерировать.


\subsubsection{Локальные и глобальные условия}
Архитектура WaveNet предоставляет два способа передачи условий: глобальное условие и локальное условие.
Глобальное условие характеризуется единственным скрытым представлением $\bf{h}$, которое оказывает влияние на
финальное распределение вдоль всего временного промежутка. 
Функция активации из формулы \ref{eq:activation_func} теперь принимает вид \ref{eq:activation_func_cond}:


\begin{equation} \label{eq:activation_func_cond}
z = \tanh(W_{f,k} * x + V_{f,k}^T h~\astrosun~\sigma (W_{g,k} * x + V_{g,k}^T h)).
\end{equation}

где $V_{*,k}$ это свёртка $1 \times 1$. В качестве альтернативы такой миниатюрной свёрточной сети можно
использовать $V_{f,k} * h$ и продублировать это значения по времени. Однако, авторы утверждают, 
что такой подход работает гораздо хуже на практике.  


\end{document}

